<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IKB: Identity Knowledge Base - Interactive Architecture</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Font Awesome for Icons (No SVG tags used directly) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Chosen Palette: Cyberpunk Theme -->
    <!-- Colors: 
        Background: #0a0a0a (Deep Black)
        Primary Surface: #1a1a1a (Charcoal Black)
        Primary Text: #e0e0e0 (Light Gray)
        Accent Blue: #00d4ff (Cyan Blue) - Represents Verification/Core
        Accent Deep Blue: #1e3a8a (Deep Blue) - Primary accent
        Accent Purple: #a855f7 (Purple) - Represents Encryption/Gateway
        Accent Teal: #14b8a6 (Teal) - Represents Mesh/Routing
        Secondary Surface: #0a1929 (Dark Blue)
    -->

    <!-- Application Structure Plan:
        1.  **Hero Section:** High-level value proposition ("Zero-Token Security").
        2.  **Executive Overview:** Interactive cards explaining the core problem/solution.
        3.  **Interactive Architecture Flow:** A custom-built HTML/CSS visualizer replacing the ASCII diagram. Users click through the 6 steps of the cryptographic flow to see how data moves and transforms.
        4.  **Component Deep Dive (Tabs):** Detailed breakdown of Gateway, Core, and Mesh. Users can toggle between these to see responsibilities and JSON packet structures without scrolling endlessly.
        5.  **Performance Lab (Dashboard):** - Chart.js Bar Chart for Verification Timing (showing the sub-50ms speed).
            - Plotly.js Line Chart for Complexity Analysis (visualizing O(n) scalability).
        6.  **Versus Arena (Comparison):** Interactive table comparing IKB vs JWT.
        7.  **Benefits Grid:** Summary of key advantages.
        
        Rationale: This structure breaks the dense technical documentation into digestible, interactive layers. The "Flow" is central to understanding IKB, so it gets a dedicated interactive stepper.
    -->

    <!-- Visualization & Content Choices:
        1.  **Architecture Diagram:** HTML/CSS Grid + JS Class switching.
            - Goal: Explain the linear flow.
            - Viz: Step-by-step highlighter.
            - Interaction: Next/Prev buttons.
            - Justification: Static diagrams are boring; step-through teaches the logic.
        2.  **Verification Timing:** Chart.js Horizontal Bar.
            - Goal: Prove speed.
            - Viz: Stacked or simple bar showing ms per stage.
            - Interaction: Tooltips with specific ms values.
            - Justification: Standard bar chart is best for comparing time intervals.
        3.  **Time Complexity:** Plotly.js Line Chart.
            - Goal: Show scalability.
            - Viz: Mathematical function plotting (n vs time).
            - Justification: Plotly excels at scientific/math plotting.
        4.  **Comparison Matrix:** HTML Table with Row Highlighting.
            - Goal: Contrast IKB vs JWT.
            - Interaction: Hover effects to focus on specific features.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            background-color: #0a0a0a;
            color: #e0e0e0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        /* Custom Utilities */
        .glass-panel {
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 212, 255, 0.2);
            box-shadow: 0 4px 6px -1px rgba(0, 212, 255, 0.1);
        }

        .step-active {
            border-color: #00d4ff;
            background-color: #0a1929;
            transform: scale(1.02);
            box-shadow: 0 10px 15px -3px rgba(0, 212, 255, 0.4), 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .step-inactive {
            border-color: #2a2a2a;
            background-color: #1a1a1a;
            opacity: 0.7;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 500px;
        }

        .tab-active {
            border-bottom: 2px solid #00d4ff;
            color: #00d4ff;
            font-weight: 600;
        }

        .tab-inactive {
            border-bottom: 2px solid transparent;
            color: #9ca3af;
        }

        .code-block {
            font-family: 'Courier New', Courier, monospace;
            background-color: #0a0a0a;
            color: #00d4ff;
            border: 1px solid #1e3a8a;
        }

        /* Transition for the flow steps */
        .flow-box {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Cyberpunk glow effects */
        .cyber-glow {
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
    </style>
</head>

<body class="antialiased">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 glass-panel border-b border-blue-900" style="border-color: #1e3a8a;">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-xl font-bold tracking-tight" style="color: #00d4ff;">
                        <i class="fa-solid fa-shield-halved mr-2" style="color: #00d4ff;"></i>IKB <span
                            class="font-light" style="color: #6b7280;">Docs v2.0</span>
                    </span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <button onclick="scrollToSection('architecture')" class="px-3 py-2 text-sm font-medium"
                        style="color: #9ca3af;" onmouseover="this.style.color='#00d4ff'"
                        onmouseout="this.style.color='#9ca3af'">Architecture Flow</button>
                    <button onclick="scrollToSection('components')" class="px-3 py-2 text-sm font-medium"
                        style="color: #9ca3af;" onmouseover="this.style.color='#00d4ff'"
                        onmouseout="this.style.color='#9ca3af'">Components</button>
                    <button onclick="scrollToSection('performance')" class="px-3 py-2 text-sm font-medium"
                        style="color: #9ca3af;" onmouseover="this.style.color='#00d4ff'"
                        onmouseout="this.style.color='#9ca3af'">Performance</button>
                    <button onclick="scrollToSection('comparison')" class="px-3 py-2 text-sm font-medium"
                        style="color: #9ca3af;" onmouseover="this.style.color='#00d4ff'"
                        onmouseout="this.style.color='#9ca3af'">IKB vs JWT</button>
                </div>
                <!-- Mobile menu button placeholder -->
                <div class="md:hidden flex items-center">
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="relative bg-white overflow-hidden">
        <div class="max-w-7xl mx-auto">
            <div class="relative z-10 pb-8 bg-white sm:pb-16 md:pb-20 lg:max-w-2xl lg:w-full lg:pb-28 xl:pb-32">
                <main class="mt-10 mx-auto max-w-7xl px-4 sm:mt-12 sm:px-6 md:mt-16 lg:mt-20 lg:px-8 xl:mt-28">
                    <div class="sm:text-center lg:text-left">
                        <h1 class="text-4xl tracking-tight font-extrabold text-gray-900 sm:text-5xl md:text-6xl">
                            <span class="block xl:inline">Identity Knowledge Base</span>
                            <span class="block text-blue-600">Zero-Token Security</span>
                        </h1>
                        <p
                            class="mt-3 text-base text-gray-500 sm:mt-5 sm:text-lg sm:max-w-xl sm:mx-auto md:mt-5 md:text-xl lg:mx-0">
                            A next-generation framework replacing traditional tokens with <strong>per-request
                                cryptographic verification</strong>.
                            Built for ultra-secure distributed systems and zero-trust architectures.
                        </p>
                        <div class="mt-5 sm:mt-8 sm:flex sm:justify-center lg:justify-start">
                            <div class="rounded-md shadow">
                                <a href="#architecture"
                                    class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 md:py-4 md:text-lg">
                                    Explore Architecture
                                </a>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
        <div class="lg:absolute lg:inset-y-0 lg:right-0 lg:w-1/2 bg-gray-50 flex items-center justify-center">
            <!-- Conceptual visual using CSS/HTML -->
            <div class="grid grid-cols-2 gap-4 p-8 opacity-75">
                <div class="p-6 bg-white rounded-xl shadow-lg transform rotate-3 border-l-4 border-blue-500">
                    <i class="fa-solid fa-lock text-3xl text-blue-500 mb-2"></i>
                    <h3 class="font-bold">Zero Tokens</h3>
                    <p class="text-sm text-gray-500">No reusable session tokens to steal.</p>
                </div>
                <div class="p-6 bg-white rounded-xl shadow-lg transform -rotate-2 border-l-4 border-orange-500 mt-8">
                    <i class="fa-solid fa-microchip text-3xl text-orange-500 mb-2"></i>
                    <h3 class="font-bold">Device Bound</h3>
                    <p class="text-sm text-gray-500">Identity tied to hardware.</p>
                </div>
                <div class="p-6 bg-white rounded-xl shadow-lg transform -rotate-3 border-l-4 border-teal-500">
                    <i class="fa-solid fa-bolt text-3xl text-teal-500 mb-2"></i>
                    <h3 class="font-bold">Low Latency</h3>
                    <p class="text-sm text-gray-500">
                        < 50ms verification time.</p>
                </div>
                <div class="p-6 bg-white rounded-xl shadow-lg transform rotate-2 border-l-4 border-purple-500 mt-8">
                    <i class="fa-solid fa-network-wired text-3xl text-purple-500 mb-2"></i>
                    <h3 class="font-bold">Mesh Routing</h3>
                    <p class="text-sm text-gray-500">Intelligent policy enforcement.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Section: Executive Summary / The Why -->
    <div class="bg-gray-50 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-base font-semibold text-blue-600 tracking-wide uppercase">The Problem & Solution</h2>
                <p class="mt-2 text-3xl leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl">
                    Why Move to IKB?
                </p>
                <p class="mt-4 max-w-2xl text-xl text-gray-500 mx-auto">
                    Traditional JWT and OAuth implementations rely on reusable tokens, creating a persistent attack
                    surface. IKB closes this gap.
                </p>
            </div>

            <div class="mt-10">
                <dl class="space-y-10 md:space-y-0 md:grid md:grid-cols-2 md:gap-x-8 md:gap-y-10">
                    <div class="relative">
                        <dt>
                            <div
                                class="absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white">
                                <i class="fa-solid fa-shield-virus"></i>
                            </div>
                            <p class="ml-16 text-lg leading-6 font-medium text-gray-900">Zero-Trust Architecture</p>
                        </dt>
                        <dd class="mt-2 ml-16 text-base text-gray-500">
                            Never trust, always verify. Every single request is cryptographically validated
                            independently.
                        </dd>
                    </div>

                    <div class="relative">
                        <dt>
                            <div
                                class="absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white">
                                <i class="fa-solid fa-fingerprint"></i>
                            </div>
                            <p class="ml-16 text-lg leading-6 font-medium text-gray-900">Device-Level Identity</p>
                        </dt>
                        <dd class="mt-2 ml-16 text-base text-gray-500">
                            Uses asymmetric cryptography and envelope encryption to bind identity to the specific
                            device.
                        </dd>
                    </div>

                    <div class="relative">
                        <dt>
                            <div
                                class="absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white">
                                <i class="fa-solid fa-eye"></i>
                            </div>
                            <p class="ml-16 text-lg leading-6 font-medium text-gray-900">Deep Observability</p>
                        </dt>
                        <dd class="mt-2 ml-16 text-base text-gray-500">
                            Integrated W3C Trace Context headers provide full visibility into request latency and
                            traffic routing.
                        </dd>
                    </div>

                    <div class="relative">
                        <dt>
                            <div
                                class="absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white">
                                <i class="fa-solid fa-server"></i>
                            </div>
                            <p class="ml-16 text-lg leading-6 font-medium text-gray-900">High-Throughput</p>
                        </dt>
                        <dd class="mt-2 ml-16 text-base text-gray-500">
                            Designed for microservices with stateless operation across Gateway, Core, and Mesh layers.
                        </dd>
                    </div>
                </dl>
            </div>
        </div>
    </div>

    <!-- Section: Interactive Architecture Flow -->
    <div id="architecture" class="py-16 bg-white border-t border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="lg:text-center mb-12">
                <h2 class="text-base text-blue-600 font-semibold tracking-wide uppercase">System Architecture</h2>
                <p class="mt-2 text-3xl leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl">
                    The Cryptographic Pipeline
                </p>
                <p class="mt-4 max-w-2xl text-xl text-gray-500 lg:mx-auto">
                    Understand how a request travels from the client to the target service. This linear flow ensures
                    security gates at every transition.
                    <br><span class="text-sm font-bold text-blue-500">Click "Next Step" to trace the packet.</span>
                </p>
            </div>

            <!-- Interactive Flow Component -->
            <div class="bg-gray-50 rounded-2xl p-6 lg:p-10 shadow-inner border border-gray-200">

                <!-- Controls -->
                <div class="flex justify-center space-x-4 mb-8">
                    <button id="prevStepBtn"
                        class="bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 px-4 py-2 rounded-md shadow-sm text-sm font-medium disabled:opacity-50 transition-colors">
                        <i class="fa-solid fa-arrow-left mr-2"></i> Previous
                    </button>
                    <span id="stepIndicator" class="flex items-center px-4 font-mono font-bold text-blue-600">Step
                        1/6</span>
                    <button id="nextStepBtn"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md shadow-sm text-sm font-medium transition-colors">
                        Next <i class="fa-solid fa-arrow-right ml-2"></i>
                    </button>
                </div>

                <!-- Diagram Visualization -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 relative min-h-[300px]">

                    <!-- Component 1: Client -->
                    <div id="comp-client"
                        class="flow-box p-4 rounded-lg border-2 border-gray-200 bg-white flex flex-col items-center justify-center text-center relative z-10 h-48">
                        <i class="fa-solid fa-laptop text-4xl mb-3 text-gray-600"></i>
                        <h4 class="font-bold text-lg">Client</h4>
                        <div id="desc-client" class="text-xs text-gray-500 mt-2 hidden">
                            Signs & Encrypts Request.<br>Gen Timestamp & Nonce.
                        </div>
                    </div>

                    <!-- Arrow 1 -->
                    <div class="hidden md:flex items-center justify-center text-gray-300">
                        <i class="fa-solid fa-arrow-right text-2xl"></i>
                    </div>

                    <!-- Component 2: Gateway -->
                    <div id="comp-gateway"
                        class="flow-box p-4 rounded-lg border-2 border-gray-200 bg-white flex flex-col items-center justify-center text-center relative z-10 h-48">
                        <i class="fa-solid fa-door-open text-4xl mb-3 text-gray-600"></i>
                        <h4 class="font-bold text-lg">Gateway</h4>
                        <div id="desc-gateway" class="text-xs text-gray-500 mt-2 hidden">
                            Normalizes Request.<br>Forwards to Core.<br>Builds MeshPacket.
                        </div>
                    </div>

                    <!-- Arrow 2 -->
                    <div class="hidden md:flex items-center justify-center text-gray-300">
                        <i class="fa-solid fa-arrow-right text-2xl"></i>
                    </div>

                    <!-- Component 3: Core -->
                    <div id="comp-core"
                        class="flow-box p-4 rounded-lg border-2 border-gray-200 bg-white flex flex-col items-center justify-center text-center relative z-10 h-48">
                        <i class="fa-solid fa-key text-4xl mb-3 text-gray-600"></i>
                        <h4 class="font-bold text-lg">IKB Core</h4>
                        <div id="desc-core" class="text-xs text-gray-500 mt-2 hidden">
                            Decrypts Envelope.<br>Verifies Signature.<br>Aggregates Roles.
                        </div>
                    </div>

                    <!-- This row wraps on mobile, visually tricky. For simple stacked layout: -->
                </div>

                <!-- Row 2 for Mesh and Target (simulating the return trip and forward) -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 relative min-h-[300px] mt-4">
                    <!-- Spacer for alignment -->
                    <div class="hidden md:block"></div>
                    <div class="hidden md:block"></div>

                    <!-- Component 4: Mesh -->
                    <div id="comp-mesh"
                        class="flow-box p-4 rounded-lg border-2 border-gray-200 bg-white flex flex-col items-center justify-center text-center relative z-10 h-48">
                        <i class="fa-solid fa-share-nodes text-4xl mb-3 text-gray-600"></i>
                        <h4 class="font-bold text-lg">Mesh</h4>
                        <div id="desc-mesh" class="text-xs text-gray-500 mt-2 hidden">
                            Enforces RBAC.<br>Resolves Route.<br>Multi-level Caching.
                        </div>
                    </div>

                    <!-- Component 5: Target -->
                    <div id="comp-target"
                        class="flow-box p-4 rounded-lg border-2 border-gray-200 bg-white flex flex-col items-center justify-center text-center relative z-10 h-48">
                        <i class="fa-solid fa-bullseye text-4xl mb-3 text-gray-600"></i>
                        <h4 class="font-bold text-lg">Target App</h4>
                        <div id="desc-target" class="text-xs text-gray-500 mt-2 hidden">
                            Receives clean request.<br>Executes logic.
                        </div>
                    </div>
                </div>

                <!-- Narrative Text -->
                <div class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-4">
                    <h5 class="text-blue-800 font-bold mb-1">Current Action:</h5>
                    <p id="flow-narrative" class="text-gray-700">Ready to start. Click 'Next' to initiate a request.</p>
                </div>

            </div>
        </div>
    </div>

    <!-- Section: Component Deep Dive (Tabs) -->
    <div id="components" class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-extrabold text-gray-900">Component Breakdown</h2>
                <p class="mt-4 text-gray-500">Explore the responsibilities and data structures of the three main
                    pillars.</p>
            </div>

            <!-- Tab Headers -->
            <div class="flex justify-center border-b border-gray-200 mb-8">
                <button onclick="switchTab('gateway')" id="tab-gateway"
                    class="tab-active px-6 py-3 text-lg focus:outline-none transition-colors">
                    IKB Gateway
                </button>
                <button onclick="switchTab('core')" id="tab-core"
                    class="tab-inactive px-6 py-3 text-lg focus:outline-none transition-colors">
                    IKB Core
                </button>
                <button onclick="switchTab('mesh')" id="tab-mesh"
                    class="tab-inactive px-6 py-3 text-lg focus:outline-none transition-colors">
                    IKB Mesh
                </button>
            </div>

            <!-- Tab Content: Gateway -->
            <div id="content-gateway" class="grid grid-cols-1 lg:grid-cols-2 gap-8 animate-fade-in">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Gateway Responsibilities</h3>
                    <ul class="space-y-3 text-gray-600">
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Request Normalization:</strong> Ensures protocol standards.</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Circuit Breakers:</strong> Fault tolerance & rate limiting.</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Route Resolution:</strong> Maps <code>/api/v1/*</code> to upstream
                                services.</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Distributed Tracing:</strong> Injects W3C Trace Context.</span>
                        </li>
                    </ul>
                </div>
                <div class="bg-gray-900 p-6 rounded-lg shadow-inner">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-gray-400 text-xs uppercase font-bold">MeshPacket Structure (Generated by
                            Gateway)</span>
                        <div class="flex space-x-1">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        </div>
                    </div>
                    <pre class="code-block text-sm overflow-x-auto whitespace-pre-wrap">
{
  "meta": {
    "method": "POST",
    "path": "/orders/create",
    "applicationId": "app_orders_01"
  },
  "roles": ["USER", "ADMIN"],
  "body": {
    "decrypted content": "..."
  },
  "headers": {
      "X-IKB-Verified-Uid": "u_88291",
      "X-IKB-Verified-Did": "d_11234",
      "X-IKB-Verified-Aid": "a_99881",
      "X-IKB-Verified-ApplicationKey": "..."
  }
}
</pre>
                </div>
            </div>

            <!-- Tab Content: Core -->
            <div id="content-core" class="hidden grid-cols-1 lg:grid-cols-2 gap-8 animate-fade-in">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Core Engine Responsibilities</h3>
                    <ul class="space-y-3 text-gray-600">
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Envelope Decryption:</strong> Unlocks device secrets/session keys.</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Signature Verification:</strong> ECDSA or HMAC-SHA256 checks.</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Replay Protection:</strong> Nonce + Timestamp (±5 min window).</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Role Aggregation:</strong> Computes roles from device/account policies.</span>
                        </li>
                    </ul>
                </div>
                <div class="bg-gray-900 p-6 rounded-lg shadow-inner">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-gray-400 text-xs uppercase font-bold">Verification Output (/ikb/verify)</span>
                        <div class="flex space-x-1">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        </div>
                    </div>
                    <pre class="code-block text-sm overflow-x-auto whitespace-pre-wrap">
{
  "uid": "u_88291",
  "did": "d_11234",
  "aid": "a_99881",
  "roles": ["USER"],
  "applicationKey": "key_v2_...",
  "body": {
    "decrypted payload": "..."
  }
}
</pre>
                </div>
            </div>

            <!-- Tab Content: Mesh -->
            <div id="content-mesh" class="hidden grid-cols-1 lg:grid-cols-2 gap-8 animate-fade-in">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Mesh & Routing Responsibilities</h3>
                    <ul class="space-y-3 text-gray-600">
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>RBAC Enforcement:</strong> Validates <code>mesh-policies.yml</code>.</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Security Checks:</strong> Validates Gateway HMAC & Timestamps.</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Multi-Level Caching:</strong> L1 (Caffeine) & L2 (Redis).</span>
                        </li>
                        <li class="flex items-start"><i class="fa-solid fa-check text-green-500 mt-1 mr-2"></i>
                            <span><strong>Secure Forwarding:</strong> WebClient POST to internal service.</span>
                        </li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">Caching Strategy</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">L1 Cache (Caffeine)</span>
                            <span class="text-green-600 font-bold">&lt;1ms latency</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">L2 Cache (Redis)</span>
                            <span class="text-blue-600 font-bold">1–3ms latency</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">DB Fallback</span>
                            <span class="text-orange-600 font-bold">10–20ms latency</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Section: Performance Lab -->
    <div id="performance" class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="mb-12">
                <h2 class="text-3xl font-extrabold text-gray-900">Performance Lab</h2>
                <p class="mt-4 text-gray-500">IKB is engineered for speed. Explore the timing metrics and complexity
                    analysis below.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Chart 1: Verification Timing -->
                <div>
                    <h3 class="text-lg font-bold text-gray-800 mb-4">Core Verification Timing (ms)</h3>
                    <p class="text-sm text-gray-500 mb-4">Breakdown of the 24-50ms verification window.</p>
                    <div class="chart-container bg-white p-2 rounded-lg border border-gray-100 shadow-sm">
                        <canvas id="timingChart"></canvas>
                    </div>
                    <div class="mt-4 text-sm text-gray-500 italic text-center">
                        Total Core Verification: <strong>24–50ms</strong>
                    </div>
                </div>

                <!-- Chart 2: Complexity Analysis -->
                <div>
                    <h3 class="text-lg font-bold text-gray-800 mb-4">Time Complexity Analysis</h3>
                    <p class="text-sm text-gray-500 mb-4">Theoretical scaling of IKB Core vs. Linear Growth.</p>
                    <div
                        class="chart-container bg-white p-2 rounded-lg border border-gray-100 shadow-sm flex items-center justify-center">
                        <div id="complexityChart" style="width:100%; height:100%;"></div>
                    </div>
                    <div class="mt-4 grid grid-cols-3 gap-2 text-center text-xs text-gray-600">
                        <div class="bg-gray-100 p-2 rounded">
                            <strong>Gateway</strong><br>O(1)
                        </div>
                        <div class="bg-gray-100 p-2 rounded">
                            <strong>Mesh</strong><br>O(n + r)
                        </div>
                        <div class="bg-blue-100 p-2 rounded">
                            <strong>Core</strong><br>O(n + log m)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section: Comparison (IKB vs JWT) -->
    <div id="comparison" class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-extrabold text-gray-900 mb-8 text-center">The Showdown: IKB vs. JWT</h2>

            <div class="overflow-x-auto shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
                <table class="min-w-full divide-y divide-gray-300">
                    <thead class="bg-gray-800 text-white">
                        <tr>
                            <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold sm:pl-6">Feature
                            </th>
                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-300">JWT
                                (Traditional)</th>
                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-blue-400">IKB
                                (Zero-Trust)</th>
                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold">Advantage</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 bg-white" id="comparison-body">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
            <p class="mt-4 text-center text-gray-500 font-medium">Conclusion: IKB provides a superior foundation for
                Zero-Trust Architectures.</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12 border-t border-gray-800">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-gray-400">&copy; 2025 FrostFire FusioneX. All rights reserved.</p>
            <p class="text-sm text-gray-500 mt-2">Identity Knowledge Base Technical Documentation v2.0</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // State Management
        const state = {
            currentStep: 0,
            totalSteps: 6,
            currentTab: 'gateway'
        };

        // --- 1. Architecture Flow Logic ---
        const steps = [
            { comp: 'comp-client', title: 'Step 1: Client', desc: 'Client signs & encrypts the request. Generates timestamp & nonce. NO reusable token used.', arrow: null },
            { comp: 'comp-gateway', title: 'Step 2: Gateway', desc: 'Gateway receives encrypted payload. Enforces rate limits. Forwards to Core.', arrow: 'comp-client' },
            { comp: 'comp-core', title: 'Step 3: Core (Verify)', desc: 'Core decrypts envelope/identity/body. Verifies signature & nonce. Aggregates roles.', arrow: 'comp-gateway' },
            { comp: 'comp-core', title: 'Step 4: Core (Response)', desc: 'Core returns verified identity context (UID, DID, Roles) to Gateway.', arrow: null },
            { comp: 'comp-gateway', title: 'Step 5: Gateway (Build)', desc: 'Gateway constructs MeshPacket with Verified headers. Signs with HMAC.', arrow: 'comp-core' },
            { comp: 'comp-mesh', title: 'Step 6: Mesh -> Target', desc: 'Mesh validates packet, checks RBAC policies, and forwards to Target App.', arrow: 'comp-gateway' }
        ];

        const nextBtn = document.getElementById('nextStepBtn');
        const prevBtn = document.getElementById('prevStepBtn');
        const narrative = document.getElementById('flow-narrative');
        const stepIndicator = document.getElementById('stepIndicator');

        function updateArchitectureVisuals() {
            // Reset all boxes
            document.querySelectorAll('.flow-box').forEach(el => {
                el.classList.remove('step-active');
                el.classList.add('step-inactive');
                el.querySelector('div[id^="desc-"]').classList.add('hidden');
            });

            // Logic to highlight current path
            const currentData = steps[state.currentStep - 1]; // 0-indexed array vs 1-based step

            if (state.currentStep > 0 && currentData) {
                const activeEl = document.getElementById(currentData.comp);
                if (activeEl) {
                    activeEl.classList.remove('step-inactive');
                    activeEl.classList.add('step-active');
                    activeEl.querySelector('div[id^="desc-"]').classList.remove('hidden');
                    narrative.innerHTML = `<span class="font-bold text-blue-600">${currentData.title}:</span> ${currentData.desc}`;
                }
            } else {
                narrative.innerHTML = "Ready to start. Click 'Next' to initiate a request.";
            }

            stepIndicator.textContent = `Step ${state.currentStep}/6`;

            // Button States
            prevBtn.disabled = state.currentStep === 0;
            nextBtn.disabled = state.currentStep === 6;
            if (state.currentStep === 6) {
                nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        nextBtn.addEventListener('click', () => {
            if (state.currentStep < 6) {
                state.currentStep++;
                updateArchitectureVisuals();
            }
        });

        prevBtn.addEventListener('click', () => {
            if (state.currentStep > 0) {
                state.currentStep--;
                updateArchitectureVisuals();
            }
        });

        // --- 2. Tab Logic ---
        function switchTab(tabName) {
            // Headers
            ['gateway', 'core', 'mesh'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if (t === tabName) {
                    btn.classList.remove('tab-inactive');
                    btn.classList.add('tab-active');
                } else {
                    btn.classList.add('tab-inactive');
                    btn.classList.remove('tab-active');
                }
            });

            // Content
            ['gateway', 'core', 'mesh'].forEach(t => {
                const content = document.getElementById(`content-${t}`);
                if (t === tabName) {
                    content.classList.remove('hidden');
                    content.classList.add('grid');
                } else {
                    content.classList.add('hidden');
                    content.classList.remove('grid');
                }
            });
        }

        // --- 3. Charts Logic ---
        function initCharts() {
            // Chart.js: Verification Timing
            const ctxTiming = document.getElementById('timingChart').getContext('2d');
            new Chart(ctxTiming, {
                type: 'bar',
                data: {
                    labels: ['Envelope Decrypt', 'Identity Decrypt', 'Body Decrypt', 'Sig Verify', 'Timestamp/Nonce', 'Role Aggregation'],
                    datasets: [{
                        label: 'Processing Time (ms)',
                        data: [7.5, 7.5, 20, 3.5, 0.5, 1.5], // Averages from ranges
                        backgroundColor: [
                            'rgba(249, 115, 22, 0.6)', // Orange
                            'rgba(249, 115, 22, 0.6)',
                            'rgba(249, 115, 22, 0.8)', // Darker Orange for heavy lift
                            'rgba(59, 130, 246, 0.6)', // Blue
                            'rgba(59, 130, 246, 0.6)',
                            'rgba(20, 184, 166, 0.6)'  // Teal
                        ],
                        borderColor: [
                            'rgba(249, 115, 22, 1)',
                            'rgba(249, 115, 22, 1)',
                            'rgba(249, 115, 22, 1)',
                            'rgba(59, 130, 246, 1)',
                            'rgba(59, 130, 246, 1)',
                            'rgba(20, 184, 166, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y', // Horizontal bar
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: { display: true, text: 'Milliseconds (ms)' }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.raw} ms (Avg)`
                            }
                        }
                    }
                }
            });

            // Plotly.js: Complexity Analysis
            // Simulating n data points
            const n = Array.from({ length: 20 }, (_, i) => i + 1);

            // O(1) - Gateway
            const yGateway = n.map(() => 1);

            // O(n + log m) - Core (Simulated where m is constant 100)
            const yCore = n.map(val => val + Math.log(100));

            // O(n + r) - Mesh (Simulated where r is constant 10)
            const yMesh = n.map(val => val + 10);

            const traceCore = {
                x: n, y: yCore,
                mode: 'lines+markers',
                name: 'Core O(n + log m)',
                line: { color: '#3b82f6', width: 3 }
            };

            const traceMesh = {
                x: n, y: yMesh,
                mode: 'lines',
                name: 'Mesh O(n + r)',
                line: { color: '#14b8a6', dash: 'dot' }
            };

            const traceGateway = {
                x: n, y: yGateway,
                mode: 'lines',
                name: 'Gateway O(1)',
                line: { color: '#6b7280' }
            };

            const layout = {
                title: { text: 'Performance Scaling vs Payload Size (n)', font: { size: 14 } },
                xaxis: { title: 'Payload Size (n)' },
                yaxis: { title: 'Relative Operations' },
                margin: { t: 40, r: 10, l: 40, b: 40 },
                showlegend: true,
                legend: { x: 0.05, y: 1 },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            Plotly.newPlot('complexityChart', [traceCore, traceMesh, traceGateway], layout, { responsive: true, displayModeBar: false });
        }

        // --- 4. Comparison Table Population ---
        const comparisonData = [
            { feat: "Token Reuse", jwt: "Always possible", ikb: "None", adv: "IKB" },
            { feat: "Replay Protection", jwt: "Weak", ikb: "Strong (Nonce+Time)", adv: "IKB" },
            { feat: "Encryption", jwt: "Optional (JWE)", ikb: "Mandatory", adv: "IKB" },
            { feat: "Signature", jwt: "Static", ikb: "Dynamic (Per-Request)", adv: "IKB" },
            { feat: "Device Identity", jwt: "No", ikb: "Yes", adv: "IKB" },
            { feat: "Token Theft Risk", jwt: "High", ikb: "Zero", adv: "IKB" }
        ];

        function renderComparison() {
            const tbody = document.getElementById('comparison-body');
            tbody.innerHTML = comparisonData.map((row, index) => `
                <tr class="${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'} hover:bg-blue-50 transition-colors cursor-default">
                    <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6">${row.feat}</td>
                    <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">${row.jwt}</td>
                    <td class="whitespace-nowrap px-3 py-4 text-sm text-blue-700 font-bold">${row.ikb}</td>
                    <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                        ${row.adv === 'IKB' ? '<i class="fa-solid fa-trophy text-yellow-500"></i>' : ''}
                    </td>
                </tr>
            `).join('');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            renderComparison();
            updateArchitectureVisuals(); // Set initial state
        });

        // Navigation Smooth Scroll
        window.scrollToSection = (id) => {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

    </script>
</body>

</html>